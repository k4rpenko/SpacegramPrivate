<main>
  <div class="user-chats">
    <div class="header-user-chats">
        <h1>Messages</h1>
        <div class="header-user-chats-menu">
            <a><svg viewBox="0 0 24 24" aria-hidden="true" style="fill: #fff;"><g><path d="M10.54 1.75h2.92l1.57 2.36c.11.17.32.25.53.21l2.53-.59 2.17 2.17-.58 2.54c-.05.2.04.41.21.53l2.36 1.57v2.92l-2.36 1.57c-.17.12-.26.33-.21.53l.58 2.54-2.17 2.17-2.53-.59c-.21-.04-.42.04-.53.21l-1.57 2.36h-2.92l-1.58-2.36c-.11-.17-.32-.25-.52-.21l-2.54.59-2.17-2.17.58-2.54c.05-.2-.03-.41-.21-.53l-2.35-1.57v-2.92L4.1 8.97c.18-.12.26-.33.21-.53L3.73 5.9 5.9 3.73l2.54.59c.2.04.41-.04.52-.21l1.58-2.36zm1.07 2l-.98 1.47C10.05 6.08 9 6.5 7.99 6.27l-1.46-.34-.6.6.33 1.46c.24 1.01-.18 2.07-1.05 2.64l-1.46.98v.78l1.46.98c.87.57 1.29 1.63 1.05 2.64l-.33 1.46.6.6 1.46-.34c1.01-.23 2.06.19 2.64 1.05l.98 1.47h.78l.97-1.47c.58-.86 1.63-1.28 2.65-1.05l1.45.34.61-.6-.34-1.46c-.23-1.01.18-2.07 1.05-2.64l1.47-.98v-.78l-1.47-.98c-.87-.57-1.28-1.63-1.05-2.64l.34-1.46-.61-.6-1.45.34c-1.02.23-2.07-.19-2.65-1.05l-.97-1.47h-.78zM12 10.5c-.83 0-1.5.67-1.5 1.5s.67 1.5 1.5 1.5c.82 0 1.5-.67 1.5-1.5s-.68-1.5-1.5-1.5zM8.5 12c0-1.93 1.56-3.5 3.5-3.5 1.93 0 3.5 1.57 3.5 3.5s-1.57 3.5-3.5 3.5c-1.94 0-3.5-1.57-3.5-3.5z"></path></g></svg></a>
            <a (click)="openFindPeopleComponent()"><svg viewBox="0 0 24 24" aria-hidden="true" style="fill: #fff;"><g><path d="M1.998 5.5c0-1.381 1.119-2.5 2.5-2.5h15c1.381 0 2.5 1.119 2.5 2.5V12h-2v-1.537l-8 3.635-8-3.635V18.5c0 .276.224.5.5.5H13v2H4.498c-1.381 0-2.5-1.119-2.5-2.5v-13zm2 2.766l8 3.635 8-3.635V5.5c0-.276-.224-.5-.5-.5h-15c-.276 0-.5.224-.5.5v2.766zM19 18v-3h2v3h3v2h-3v3h-2v-3h-3v-2h3z"></path></g></svg></a>
        </div>
    </div>
    <a (click)="OpenMessage(chat)" *ngFor="let chat of Chats" class="chat-item">
        <div class="chat-avatar-status">
            <img [src]="chat.user?.avatar" alt="Chat Avatar">
            <div *ngIf="chat.user?.isOnline" class="chat-online-status"></div>
        </div>
        <div class="chat-data">
            <div class="chat-text">
                <div class="chat-user">
                    <samp>{{ chat.user?.userName || 'Anonymous' }}</samp>
                </div>
                <div class="chat-user-message">
                    <samp>{{ chat.message?.text }}</samp>
                </div>
            </div>
            <div class="chat-user-message-data-status">
                <samp>{{ chat.message?.createdAt | date: 'HH:mm' }}</samp>
                <div class="chat-user-message-status" *ngIf="chat.message?.idUser === YouID else enother">
                    <div *ngIf="chat.message?.view else notView">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" preserveAspectRatio="xMidYMid meet" [ngStyle]="{ fill: 'white' }">
                            <g transform="translate(0.000000,512.000000) scale(0.100000,-0.100000)">
                                <path d="M3249 3826 c-19 -7 -45 -19 -57 -28 -12 -8 -358 -347 -770 -754 -411 -406 -840 -830 -953 -942 l-206 -203 -401 418 c-221 230 -423 435 -449 455 -130 102 -310 60 -389 -92 -29 -55 -26 -163 6 -222 16 -30 201 -229 512 -551 268 -278 512 -527 541 -554 59 -54 108 -73 183 -73 105 0 69 -33 1204 1090 580 574 1065 1057 1078 1074 69 94 49 256 -41 332 -72 61 -174 80 -258 50z"/>
                                <path d="M4777 3816 c-20 -8 -52 -25 -70 -40 -17 -14 -452 -442 -966 -950 l-935 -925 -63 59 c-103 96 -204 113 -315 53 -85 -46 -128 -121 -128 -223 0 -70 17 -117 61 -169 81 -94 295 -302 328 -317 20 -10 64 -20 98 -22 121 -8 57 -65 1218 1083 578 572 1060 1053 1072 1071 92 133 22 328 -136 382 -45 16 -117 14 -164 -2z"/>
                            </g>
                        </svg>
                    </div>
                    <ng-template #notView>
                      <svg
                        xmlns="http://www.w3.org/2000/svg"
                        viewBox="0 0 512 512"
                        preserveAspectRatio="xMidYMid meet"
                        [ngStyle]="{ fill: 'white' }"
                      >
                        <g transform="translate(0.000000,512.000000) scale(0.100000,-0.100000)">
                          <path
                            d="M3249 3826 c-19 -7 -45 -19 -57 -28 -12 -8 -358 -347 -770 -754 -411
                              -406 -840 -830 -953 -942 l-206 -203 -401 418 c-221 230 -423 435 -449 455
                              -130 102 -310 60 -389 -92 -29 -55 -26 -163 6 -222 16 -30 201 -229 512 -551
                              268 -278 512 -527 541 -554 59 -54 108 -73 183 -73 105 0 69 -33 1204 1090
                              580 574 1065 1057 1078 1074 69 94 49 256 -41 332 -72 61 -174 80 -258 50z"
                          />
                        </g>
                      </svg>
                    </ng-template>
                  </div>
                  <ng-template  #enother>
                    <div class="chat-user-message-new" *ngIf="chat.message?.view === false">
                      <div class="unread-circle">
                        <samp>1+</samp>
                      </div>
                    </div>
                  </ng-template>
                </div>
              </div>
          </a>
      </div>
      <div *ngIf="open else close">
        <div class="messages">
            <div class="messages-profile">
                <div class="messages-profile-avatar-status">
                    <img src="{{OpenChat.user?.avatar}}" alt="">
                    <div *ngIf="OpenChat.user?.isOnline" class="messages-profile-online-status"></div>
                </div>
                <div class="messages-data-status">
                    <div class="messages-data-for-user">
                        <samp>{{OpenChat.user?.userName}}</samp>
                        <samp class="chat-user-data">{{OpenChat.user?.lastName}}</samp>
                    </div>
                    <div class="chat-user-last-status" *ngIf="!OpenChat.user?.isOnline else close"><samp>був недавно</samp></div>
                    <ng-template class="chat-user-last-status-true" #close><samp>В мережі</samp></ng-template>
                </div>
            </div>
            <div class="message-text">
                <div class="message-text-list">
                    <div class="message-text-array" *ngFor="let message of OpenChat.messageArray">
                        <div
                            [ngClass]="{
                              'message-you': message.idUser === YouID,
                              'message-another': message.idUser !== YouID
                            }"
                            class="message"
                        >
                            <div class="message-text"><p>{{ message.text }}</p></div>
                            <div class="message-data-status">
                                <samp>{{ message.createdAt | date: 'HH:mm' }}</samp>
                                <div class="message-data-status-wait" *ngIf="message.idUser === YouID && message.send != true else view">
                                    <svg version="1.0" xmlns="http://www.w3.org/2000/svg"
                                    width="1280.000000pt" height="1280.000000pt" viewBox="0 0 1280.000000 1280.000000"
                                    preserveAspectRatio="xMidYMid meet">
                                        <g transform="translate(0.000000,1280.000000) scale(0.100000,-0.100000)"
                                        fill="#fff" stroke="none">
                                        <path d="M6035 12789 c-2168 -128 -4111 -1331 -5189 -3212 -443 -772 -715
                                        -1618 -810 -2517 -141 -1322 146 -2678 810 -3837 867 -1513 2307 -2605 3992
                                        -3028 1608 -404 3303 -171 4739 651 1604 917 2734 2486 3098 4299 303 1511 46
                                        3094 -721 4432 -971 1696 -2665 2858 -4589 3148 -444 67 -908 89 -1330 64z
                                        m885 -544 c593 -56 1138 -188 1683 -406 193 -78 571 -263 752 -369 869 -510
                                        1564 -1200 2095 -2080 185 -305 410 -806 533 -1185 477 -1463 353 -3061 -343
                                        -4440 -318 -629 -667 -1102 -1191 -1611 -583 -566 -1361 -1038 -2160 -1309
                                        -446 -151 -876 -243 -1374 -291 -250 -25 -780 -25 -1030 0 -498 48 -928 140
                                        -1374 291 -476 162 -996 420 -1396 692 -636 434 -1178 979 -1595 1603 -288
                                        431 -543 959 -704 1457 -475 1471 -352 3058 344 4438 69 138 161 309 205 380
                                        594 982 1424 1745 2440 2245 738 363 1478 555 2325 604 138 8 633 -4 790 -19z"/>
                                        <path d="M6150 9266 l0 -2113 -52 -22 c-318 -132 -517 -455 -494 -801 l6 -95
                                        -1092 -631 c-765 -441 -1093 -635 -1092 -647 1 -11 220 -400 239 -425 1 -1
                                        496 283 1100 632 l1098 634 51 -40 c67 -52 214 -122 301 -144 93 -24 274 -24
                                        370 -1 116 29 263 108 349 188 89 83 133 141 181 237 179 362 59 800 -280
                                        1021 -40 26 -98 58 -129 70 l-56 23 0 2114 0 2114 -250 0 -250 0 0 -2114z"/>
                                        </g>
                                    </svg>
                                </div>
                                <ng-template #view>
                                    <svg
                                    *ngIf="message.view"
                                    xmlns="http://www.w3.org/2000/svg"
                                    viewBox="0 0 512 512"
                                    preserveAspectRatio="xMidYMid meet"
                                    [ngStyle]="{ fill: 'white' }"
                                    >
                                      <g transform="translate(0.000000,512.000000) scale(0.100000,-0.100000)">
                                        <path
                                          d="M3249 3826 c-19 -7 -45 -19 -57 -28 -12 -8 -358 -347 -770 -754 -411
                                        -406 -840 -830 -953 -942 l-206 -203 -401 418 c-221 230 -423 435 -449 455
                                        -130 102 -310 60 -389 -92 -29 -55 -26 -163 6 -222 16 -30 201 -229 512 -551
                                        268 -278 512 -527 541 -554 59 -54 108 -73 183 -73 105 0 69 -33 1204 1090
                                        580 574 1065 1057 1078 1074 69 94 49 256 -41 332 -72 61 -174 80 -258 50z"
                                        />
                                        <path
                                          d="M4777 3816 c-20 -8 -52 -25 -70 -40 -17 -14 -452 -442 -966 -950
                                        l-935 -925 -63 59 c-103 96 -204 113 -315 53 -85 -46 -128 -121 -128 -223 0
                                        -70 17 -117 61 -169 81 -94 295 -302 328 -317 20 -10 64 -20 98 -22 121 -8 57
                                        -65 1218 1083 578 572 1060 1053 1072 1071 92 133 22 328 -136 382 -45 16
                                        -117 14 -164 -2z"
                                        />
                                      </g>
                                    </svg>
                                    <svg
                                      *ngIf="!message.view"
                                      xmlns="http://www.w3.org/2000/svg"
                                      viewBox="0 0 512 512"
                                      preserveAspectRatio="xMidYMid meet"
                                      [ngStyle]="{ fill: 'white' }"
                                    >
                                      <g transform="translate(0.000000,512.000000) scale(0.100000,-0.100000)">
                                        <path
                                          d="M3249 3826 c-19 -7 -45 -19 -57 -28 -12 -8 -358 -347 -770 -754 -411
                                        -406 -840 -830 -953 -942 l-206 -203 -401 418 c-221 230 -423 435 -449 455
                                        -130 102 -310 60 -389 -92 -29 -55 -26 -163 6 -222 16 -30 201 -229 512 -551
                                        268 -278 512 -527 541 -554 59 -54 108 -73 183 -73 105 0 69 -33 1204 1090
                                        580 574 1065 1057 1078 1074 69 94 49 256 -41 332 -72 61 -174 80 -258 50z"
                                        />
                                      </g>
                                    </svg>
                                </ng-template>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="send-messages">
                <form class="send-messages-input" (submit)="sendMessage()">
                    <textarea
                        [(ngModel)]="message"
                        name="message"
                        id="message"
                        placeholder="Send a new message"
                        (keydown)="handleKeydown($event)">
                    </textarea>
                    <div class="send-messages-svg">
                        <button type="submit">
                            <svg viewBox="0 0 24 24" aria-hidden="true">
                                <g>
                                    <path d="M2.504 21.866l.526-2.108C3.04 19.719 4 15.823 4 12s-.96-7.719-.97-7.757l-.527-2.109L22.236 12 2.504 21.866zM5.981 13c-.072 1.962-.34 3.833-.583 5.183L17.764 12 5.398 5.818c.242 1.349.51 3.221.583 5.183H10v2H5.981z"></path>
                                </g>
                            </svg>
                        </button>
                    </div>
                </form>
              </div>
          </div>
      </div>

      <ng-template  #close>
          <div class="chat-user-close">
              <h1>Select a message</h1>
              <h3>Choose from your existing conversations, start a new one, or just keep swimming.</h3>
          </div>

      </ng-template>

</main>
